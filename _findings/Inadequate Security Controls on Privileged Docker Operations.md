---
title: "Inadequate Security Controls on Privileged Docker Operations"
CVSS: 9.1
---

| CWE                               | [CWE-250: Execution with Unnecessary Privileges](https://cwe.mitre.org/data/definitions/250.html)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| --------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CVSS 3.1 Score                    | [9.1](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H&version=3.1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Description (Incl. Root<br>Cause) | A user has full access to the docker socket through the portainer.io service, allowing the user to modify/create docker volumes, images, and containers through the portainer.io web dashboard. This allows for the portainer.io user to create a bind mount between the host machine and container, giving full root-level access to the host machine file-system. While this is an intended feature of Docker, and thus portainer.io, it is a highly privileged operation that must be hardened and secured.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Security Impact                   | An attacker with access to the portainer.io web dashboard can potentially create a new volume with a bind mount to the host system(such as root, `/`) and create a new container mounting the volume to a directory within the container(such as `/mnt/`), this can allow the full access of the host file-system from within the container. This can be used to read, modify, and delete any file or service configuration on the host system. <br><br>Further, this can allow for privilege escalation in the form of modifying the `root` user password via `/etc/shadow` to a attacker-known value or by discovering a sensitive file that contains credentials or authentication keys, such as a SSH private key.                                                                                                                                                                                                                                                                                                                                                      |
| Affected Domain                   | (TCP/80) portainer-administration.runner.htb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Remediation                       | As these operations fall within normal docker allowed operations, it is recommended to further harden the portainer.io service, this can be done in several ways including:<br><br>1. Limit access via a principle of least privilege (PoLP) methodology, allowing users access to only what is absolutely necessary for day-to-day business operations. This includes leveraging the [multiple roles](https://docs.portainer.io/advanced/docker-roles-and-permissions) within portainer.io. <br>To prevent this instance of abuse, a hardened, secure administrator account with the role 'Environment Administrator' can be used to manage the Portainer.IO instance and its resources, while normal users can be given the role of 'Operator' or 'Helpdesk', prohibiting the creation of additional dangerous resources.<br><br>2. Ensure the Portainer.IO service is not exposed externally, this should ideally be placed within its own VLAN or internet network behind a firewall. This additionally gives the ability to whitelist specific users via IP or device. |
| External References               | https://attack.mitre.org/techniques/T1552/004/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |


Finding evidence can be seen in reports in which this finding was referenced. Finding seen in the following report(s):

[Runner - HTB Labs - External Web Penetration]({{ site.baseurl }}{% link _posts/2024-08-29-Runner-External-PT.md %}#1-inadequate-security-controls-on-privileged-docker-operations)
