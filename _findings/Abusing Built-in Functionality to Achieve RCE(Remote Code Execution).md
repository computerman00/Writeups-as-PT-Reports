---
title: "Abusing Built-in Functionality to Achieve RCE(Remote Code Execution)"
CVSS: 6.7
---

| CWE                               | [CWE-749: Exposed Dangerous Method or Function](https://cwe.mitre.org/data/definitions/749.html)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| --------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CVSS 3.1 Score                    | [6.7](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:H&version=3.1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Description (Incl. Root<br>Cause) | Through the build in theme template management options of the `Joomla!` blog service, it is possible to modify any themes PHP file to include a malicious PHP webshell. Adding a PHP webshell to any PHP file, it is possible to execute arbitrary code on the underlying system hosting the `Joomla!` webservice by visiting the theme specific URL and sending a command through URL parameters.                                                                                                                                                                                                                                                                                                                                 |
| Security Impact                   | An attacker who can gain unauthorized access to a `Joomla!` administrator account can potentially hide a malicious PHP webshell within one of the theme pages via the theme template editor in the administrator panel. A malicious PHP webshell placed in a theme page may then be leveraged to gain un-authorized remote code execution on the underlying machine running the service. An attacker can further leverage this to execute a reverse-shell payload that will grant a semi-interactive shell, giving the ability to upload malicious programs or enumerate users, files, and services on the system.                                                                                                                 |
| Affected Resource                 | (TCP/80) 10.129.230.226                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Remediation                       | Due to the fact that this is an abuse of built-in functionality makes it difficult to specifically harden. Instead, to limit impact and potential of abuse, hardening the Joomla service in general is the recommended route. <br><br>This includes ensuring the administrator account is protected with a strong password and is not re-used with other services. <br><br>Further, consider limiting access to the `/administrator` endpoint by IP address. This can be done by adding a `.htaccess` file in the root /administrator/ directory and setting `deny from all` on the directory while setting `Allow from x.x.x.x` for the administrators IP address, effectively only allowing requests from specific IP addresses. |
| External References               | https://attack.mitre.org/techniques/T1548/<br><br>https://docs.joomla.org/Security_Checklist/Joomla!_Setup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |


Finding evidence can be seen in reports in which this finding was referenced. Finding seen in the following report(s):

[Office - HTB Labs - Active Directory Penetration Test]({{ site.baseurl }}{% link _posts/2024-09-10-Office-AD-PT.md %}#6-abusing-built-in-functionality-to-achieve-rceremote-code-execution)
