---
title: "Unpatched Web Service Allowing Unauthorized Administrator Access"
CVSS: 9.0
---

| CWE                               | [CWE-306: Missing Authentication for Critical Function](https://cwe.mitre.org/data/definitions/306.html)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| --------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CVSS 3.1 Score                    | [9.0](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:H/E:H/RL:O/RC:C&version=3.1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Description (Incl. Root<br>Cause) | The TeamCity web service was found to be using an out-dated version(`2023.05.3`) with a known authentication-bypass vulnerability that allows for an attacker to obtain the Administrator session token. This can be leveraged to create a new Administrator account and achieve RCE(Remote Code Execution) through the `/app/rest/debug/processes` endpoint with the `exePath=CMD` URL parameter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Security Impact                   | An attacker can use this vulnerability to create a new account with full Administrator privileges on the TeamCity web application. This access can allow an attacker to view and create new CI/CD projects, potentially compromising secret material by directly viewing source code or sensitive information left in the build logs. An attacker can use this access to create new accounts, delete previous(Non-Administrator) accounts, start/download full service backups, or gather additional information from the service that enables lateral movement.<br><br>Further, chained with another known [public exploit](https://github.com/Zyad-Elsayed/CVE-2023-42793/blob/main/rce.py), the attacker can leverage the newly created Administrator account to enable `debug` mode. This allows an attacker to achieve RCE(Remote Code Execution) on the underlying host system through the `/app/rest/debug/processes` API endpoint, giving shell-level access to the machine as the user running the `TeamCity` service. |
| Affected Domain                   | (TCP/80) http://teamcity.runner.htb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Remediation                       | Immediately update the `TeamCity` web-application. While anything <= version `2023.05.3` is affected by this particular vulnerability, it is important to note that multiple [succeeding versions](https://www.cvedetails.com/vulnerability-list/vendor_id-15146/product_id-30795/Jetbrains-Teamcity.html) contain similar CRITICAL vulnerabilities, thus its recommended to update to the latest `TeamCity`.<br><br>If this is not possible for business or other operational reasons, it is recommended to harden access to the system, this can be done by ensuring its not exposed to the internet and other protections such as firewalls with a white-list are set up in-front of the service.                                                                                                                                                                                                                                                                                                                            |
| External References               | https://attack.mitre.org/techniques/T1190/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |

Finding evidence can be seen in reports in which this finding was referenced. Finding seen in the following report(s):

[Runner - HTB Labs - External Web Penetration]({{ site.baseurl }}{% link _posts/2024-08-29-Runner-External-PT.md %}#2-unpatched-web-service-allowing-unauthorized-administrator-access)
