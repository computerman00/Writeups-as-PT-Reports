---
title: "Password Re-use across different services"
CVSS: 7.2
---

| CWE                               | [CWE-521: Weak Password Requirements](https://cwe.mitre.org/data/definitions/521.html)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| --------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CVSS 3.1 Score                    | [7.2](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H&version=3.1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Description (Incl. Root<br>Cause) | The tester discovered a re-used password across two separate web services(TeamCity and Portainer.IO), with one being a high privilege account on a service(Portainer) that allows for privilege escalation on the host machine.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Security Impact                   | An attacker who gain access to user credentials on the first service(TeamCity) can potentially use the credentials to authenticate with the second service(Portainer.IO). With access to the Portainer.IO web portal as a privileged user, an attacker could create a new docker container with a bind mount to the host system, allowing full access to any files on the host machine. Additionally, an attacker can attach to the docker container via a `bash` shell through the web dashboard, giving quick access to anything on the host system without needing initial shell-level access to the machine. With full access to the host file-system, an attacker can potentially add/remove files, modify services, and extract sensitive data, compromising integrity, confidentiality, and availability.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Affected Domain                   | (TCP/80) teamcity.runner.htb<br>(TCP/80) portainer-administration.runner.htb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Remediation                       | Passwords should never be re-used across different services unless facilitated through a SSO(Single Sign On) service with strong credential and additional factor authentication.<br><br>It is recommended to change the password to a long(16+ character), strong password with requirements set for numerical and special characters, ideally facilitated through a password manager than can generate/store strong random passwords with a substantially secure master password.<br><br>In the longer term, exploring SSO options within the used services, such as [OAuth with Portainer](https://docs.portainer.io/admin/settings/authentication/oauth), is recommended. This allows users company wide to access services they are authorized to use, while allowing them to use a secure account across the services. This can reduce complexity in administration of services by allowing limitations to be set on sign-in location, devices, and sign-in frequency. Further, this allows for setting policies that require MFA organization-wide without modifying service configurations, enables better tracking of sign-in attempts, and also removes users passwords(or hashes) from being stored within the services database avoiding further credentials from leaking in case of a service-wide compromise. |
| External References               | https://attack.mitre.org/mitigations/M1027/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |


| CWE                               | [CWE-521: Weak Password Requirements](https://cwe.mitre.org/data/definitions/521.html)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| --------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CVSS 3.1 Score                    | [8.6](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L&version=3.1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Description (Incl. Root<br>Cause) | The tester discovered a re-used password across two separate web services(JoomlaDB and Active Directory domain user).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Security Impact                   | An attacker who gain access to user credentials on the first service(JoomlaDB) can potentially use the credentials to authenticate with the second service(Active Directory domain). <br><br>With access to the Microsoft Active Directory environment, an attacker could connect potentially enumerate users across the entire AD domain, access sensitive files stored on SMB shares, or connect directly to Windows machines via protocols such as WinRDP and WinRM.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Affected Resource                 | (TCP/80) 10.129.230.226<br>(AD) office.htb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Remediation                       | Passwords should never be re-used across different services unless facilitated through a SSO(Single Sign On) service with strong credential and additional factor authentication.<br><br>It is recommended to change the password to a long(16+ character), strong password with requirements set for numerical and special characters, ideally facilitated through a password manager than can generate/store strong random passwords with a substantially secure master password.<br><br>In the longer term, exploring SSO options within the external services is recommended. This allows users company wide to access services they are authorized to use, while allowing them to use a secure account across the services. This can reduce complexity in administration of services by allowing limitations to be set on sign-in location, devices, and sign-in frequency. Further, this allows for setting policies that require MFA organization-wide without modifying service configurations, enables better tracking of sign-in attempts, and also removes users passwords(or hashes) from being stored within the services database avoiding further credentials from leaking in case of a service-wide compromise. |
| External References               | https://attack.mitre.org/mitigations/M1027/<br><br>https://docs.joomla.org/Active_Directory_Login_Module                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |


Finding evidence can be seen in reports in which this finding was referenced. Finding seen in the following report(s):

[Runner - HTB Labs - External Web Penetration]({{ site.baseurl }}{% link _posts/2024-08-29-Runner-External-PT.md %}#4-password-re-use-across-different-services)

[Office - HTB Labs - Active Directory Penetration Test]({{ site.baseurl }}{% link _posts/2024-09-10-Office-AD-PT.md %}#2-password-re-use-across-multiple-services)
