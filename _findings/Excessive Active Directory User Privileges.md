---
title: "Excessive Active Directory User Privileges"
CVSS: 9.1
---

| CWE                               | [CWE-250: Execution with Unnecessary Privileges](https://cwe.mitre.org/data/definitions/250.html)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| --------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CVSS 3.1 Score                    | [9.1](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H&version=3.1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Description (Incl. Root<br>Cause) | It was discovered that multiple users within the Active Directory environment had excessive privileges across the domain. One user with weak credentials was a member of the `Registry Editors` group, giving full ability to edit registry keys on a system. In another found instance, a user was a member of the `Remote Management Users` and `GPO Managers` groups, with `Remote Management Users` giving direct RDP access to machines on the domain and `GPO Managers` allowing writing over the `Default Domain Controllers Policy` of the entire domain, allowing new policies to be pushed to the GPO.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Security Impact                   | An attacker who gains access to any of these users and their associated groups can potentially leverage them to further compromise the domain or network. The `Registry Editors` group may be used to enable un-safe Windows features or even completely disable anti-virus, monitoring software, or notifications. An attacker with group membership to `Remote Management Users` can use WinRM to directly connect to machines and get shell access, allowing the enumeration of machines, users, files, and the potential to further leverage any additional privileges accessible to the compromised user. Further, unauthorized access to the `GPO Managers` group is especially dangerous, as it allows an attacker control over the  `Default Domain Controllers Policy`, this gives the potential to add new policies to the GPO which could be in the form of a scheduled task that runs under the SYSTEM user. This over-privileged scheduled task can be leveraged to add a local administrator with attacker-known credentials to the system, giving full access over that domain-joined system to the attacker. |
| Affected Resource                 | (AD) office.htb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Remediation                       | Adopt the principle of least privilege for user accounts. Ensure users are only given privileges absolutely necessary to completing their day-to-day business related tasks. While this can be in the form of default Active Directory domain groups, ideally it would be further refined into custom groups that only gives users permissions to accomplish their necessary work. If a user absolutely must have high, or dangerous privileges, their account should be hardened and locked down to the maximum extent allowed by the organization. <br><br>Further, it is highly recommended that privileges of users and groups are constantly audited and monitored, being adjusted as needed to ensure no user is over-privileged for their tasks. Consider also adding additional monitoring through Windows default event logging that will trigger events/alerts whenever a dangerous privilege is used, this can be done through the default Windows [eventcreate](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/eventcreate) tool.                                              |
| External References               | https://attack.mitre.org/techniques/T1098/<br><br>https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |


Finding evidence can be seen in reports in which this finding was referenced. Finding seen in the following report(s):

[Office - HTB Labs - Active Directory Penetration Test]({{ site.baseurl }}{% link _posts/2024-09-10-Office-AD-PT.md %}#1-excessive-active-directory-user-privileges)
